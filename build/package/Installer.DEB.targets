<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <SdkDebianPackageVersion>$(SdkVersion)</SdkDebianPackageVersion>
    <SdkDebianPackageName>dotnet-dev-$(SdkDebianPackageVersion)</SdkDebianPackageName>
    <SdkDebianIntermediateDirectory>$(IntermediateDirectory)/debian/sdk</SdkDebianIntermediateDirectory>
  </PropertyGroup>

  <!-- dotnet deb-tool -->
  <PropertyGroup>
    <DotnetDebToolPackageId>dotnet-deb-tool</DotnetDebToolPackageId>
    <DotnetDebToolVersion Condition=" '$(DotnetDebToolVersion)' == '' ">1.0.0-*</DotnetDebToolVersion>
    <DotnetDebToolConsumerProjectName>dotnet-deb-tool-consumer</DotnetDebToolConsumerProjectName>
    <DotnetDebToolDir>$(IntermediateDirectory)/$(DotnetDebToolConsumerProjectName)</DotnetDebToolDir>
    <DotnetDebToolPackageSource Condition=" '$(DotnetDebToolPackageSource)' == '' "></DotnetDebToolPackageSource>
  </PropertyGroup>

  <!-- constants -->
  <PropertyGroup>
    <DebianInstalledDirectory>/usr/share/dotnet</DebianInstalledDirectory>

    <LayoutPackageRootDirName>package_root</LayoutPackageRootDirName>
    <LayoutAbsolutePlacementDirName>$</LayoutAbsolutePlacementDirName>
    <LayoutSamplesDirName>samples</LayoutSamplesDirName>
    <LayoutDocsDirName>docs</LayoutDocsDirName>
    <LayoutDebianFilesDirName>debian</LayoutDebianFilesDirName>
  </PropertyGroup>

  <!-- Package Identities -->
  <PropertyGroup>
    <SharedFxDebianPackageVersion>$(SharedFrameworkVersion)</SharedFxDebianPackageVersion>
    <SharedFxDebianPackageName>dotnet-sharedframework-$(SharedFrameworkName)-$(SharedFxDebianPackageVersion)</SharedFxDebianPackageName>
    <SharedFxDebianPackageName>$(SharedFxDebianPackageName.ToLower())</SharedFxDebianPackageName>
    <HostFxrDebianPackageVersion>$(HostFxrVersion)</HostFxrDebianPackageVersion>
    <HostFxrDebianPackageName>dotnet-hostfxr-$(HostFxrDebianPackageVersion)</HostFxrDebianPackageName>
    <HostFxrDebianPackageName>$(HostFxrDebianPackageName.ToLower())</HostFxrDebianPackageName>
    <HostDebianPackageName>dotnet-host</HostDebianPackageName>

    <AdditionalSharedFxDebianPackageVersion>$(AdditionalSharedFrameworkVersion)</AdditionalSharedFxDebianPackageVersion>
    <AdditionalSharedFxDebianPackageName>dotnet-sharedframework-$(SharedFrameworkName)-$(AdditionalSharedFxDebianPackageVersion)</AdditionalSharedFxDebianPackageName>
    <AdditionalSharedFxDebianPackageName>$(AdditionalSharedFxDebianPackageName.ToLower())</AdditionalSharedFxDebianPackageName>
    <AdditionalHostFxrDebianPackageVersion>$(AdditionalHostFxrVersion)</AdditionalHostFxrDebianPackageVersion>
    <AdditionalHostFxrDebianPackageName>dotnet-hostfxr-$(AdditionalHostFxrDebianPackageVersion)</AdditionalHostFxrDebianPackageName>
    <AdditionalHostFxrDebianPackageName>$(AdditionalHostFxrDebianPackageName.ToLower())</AdditionalHostFxrDebianPackageName>
  </PropertyGroup>

  <!-- Inputs -->
  <PropertyGroup>
    <ManpagesDirectory>$(RepoRoot)/Documentation/manpages</ManpagesDirectory>
    <EndToEndTestProject>$(RepoRoot)/test/EndToEnd/EndToEnd.csproj</EndToEndTestProject>
    <CLISdkRoot>$(Stage2Directory)/sdk</CLISdkRoot>
  </PropertyGroup>

  <!-- Output Directories -->
  <PropertyGroup>
    <DotNetDebToolOutputDirectory>$(SdkDebianIntermediateDirectory)/deb-tool-output</DotNetDebToolOutputDirectory>
    <DebianTestResultsXmlFile>$(SdkDebianIntermediateDirectory)/debian-testResults.xml</DebianTestResultsXmlFile>
  </PropertyGroup>

  <!-- Layout Directories -->
  <PropertyGroup>
    <DebianLayoutDirectory>$(SdkDebianIntermediateDirectory)/debianLayoutDirectory</DebianLayoutDirectory>
    <LayoutPackageRootDir>$(DebianLayoutDirectory)/$(LayoutPackageRootDirName)</LayoutPackageRootDir>
    <LayoutAbsolutePlacementDir>$(DebianLayoutDirectory)/$(LayoutAbsolutePlacementDirName)</LayoutAbsolutePlacementDir>
    <LayoutSamplesDir>$(DebianLayoutDirectory)/$(LayoutSamplesDirName)</LayoutSamplesDir>
    <LayoutDocsDir>$(DebianLayoutDirectory)/$(LayoutDocsDirName)</LayoutDocsDir>
    <LayoutDebianFilesDir>$(DebianLayoutDirectory)/$(LayoutDebianFilesDirName)</LayoutDebianFilesDir>
  </PropertyGroup>

  <!-- debian_config.json -->
  <PropertyGroup>
    <DebianConfigTemplateFile>$(RepoRoot)/packaging/deb/dotnet-debian_config.json</DebianConfigTemplateFile>
    <DebianConfigJsonFile>$(DebianLayoutDirectory)/debian_config.json</DebianConfigJsonFile>
  </PropertyGroup>

  <Target Name="SetupDebProps"
          DependsOnTargets="Init">
    <ItemGroup>
      <DotnetDebToolProjectJsonLines Include="{" />
      <DotnetDebToolProjectJsonLines Include="%20%20%20%20&quot;version&quot;: &quot;1.0.0-*&quot;," />
      <DotnetDebToolProjectJsonLines Include="%20%20%20%20&quot;name&quot;: &quot;$(DotnetDebToolConsumerProjectName)&quot;," />
      <DotnetDebToolProjectJsonLines Include="%20%20%20%20&quot;frameworks&quot;: { &quot;netcoreapp1.0&quot;: {}, &quot;netcoreapp1.1&quot;: {} }," />
      <DotnetDebToolProjectJsonLines Include="%20%20%20%20&quot;tools&quot;: {&quot;$(DotnetDebToolPackageId)&quot;: &quot;$(DotnetDebToolVersion)&quot; }" />
      <DotnetDebToolProjectJsonLines Include="}" />
    </ItemGroup>

    <ItemGroup>
      <CLISdkFiles Include="$(CLISdkRoot)/**/*" />
      <SdkDebManPageFiles Include="$(ManpagesDirectory)/**/*" />
    </ItemGroup>

    <ItemGroup>
      <DebianConfigTokenValues Include="%SHARED_FRAMEWORK_DEBIAN_PACKAGE_NAME%">
        <ReplacementString>$(SharedFxDebianPackageName)</ReplacementString>
      </DebianConfigTokenValues>
      <DebianConfigTokenValues Include="%SHARED_FRAMEWORK_DEBIAN_PACKAGE_NAME_ADDITIONAL%">
        <ReplacementString>$(AdditionalSharedFxDebianPackageName)</ReplacementString>
      </DebianConfigTokenValues>
      <DebianConfigTokenValues Include="%SDK_NUGET_VERSION%">
        <ReplacementString>$(SdkVersion)</ReplacementString>
      </DebianConfigTokenValues>
      <DebianConfigTokenValues Include="%CLI_SDK_BRAND_NAME%">
        <ReplacementString>$(SdkBrandName)</ReplacementString>
      </DebianConfigTokenValues>
    </ItemGroup>

    <ItemGroup>
      <TestSdkDebTaskEnvironmentVariables Include="PATH=$(DebianInstalledDirectory)$(PathListSeparator)$(PATH)" />
    </ItemGroup>
  </Target>
</Project>
