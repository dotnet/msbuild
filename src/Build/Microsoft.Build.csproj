<Project Sdk="Microsoft.NET.Sdk">

  <Import Project="..\Shared\FileSystemSources.proj" />
  <Import Project="..\Shared\DebuggingSources.proj" />

  <PropertyGroup>
    <TargetFrameworks>$(FullFrameworkTFM);$(LatestDotNetCoreForMSBuild)</TargetFrameworks>
    <RootNamespace>Microsoft.Build</RootNamespace>
    <AssemblyName>Microsoft.Build</AssemblyName>

    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <DefineConstants>$(DefineConstants);BUILD_ENGINE</DefineConstants>

    <EnableDefaultItems>false</EnableDefaultItems>

    <GenerateReferenceAssemblySource>true</GenerateReferenceAssemblySource>
    <!-- Do not create Tlbs when building in .NET product mode. The packages are not shipped to VS,
         only their contents redisted within the SDK. -->
    <CreateTlb Condition="'$(DotNetBuild)' != 'true'">true</CreateTlb>
    <IsPackable>true</IsPackable>
    <PackageDescription>This package contains the $(MSBuildProjectName) assembly which is used to create, edit, and evaluate MSBuild projects.</PackageDescription>
    <IncludeSatelliteOutputInPack>false</IncludeSatelliteOutputInPack>
    <ApplyNgenOptimization Condition="'$(TargetFramework)' == '$(FullFrameworkTFM)'">full</ApplyNgenOptimization>
    <EnablePackageValidation>true</EnablePackageValidation>
    <GeneratePackageOnBuild>True</GeneratePackageOnBuild>

    <!-- Do not generate a warning that our 'stable' package should not have a prerelease dependency. -->
    <NoWarn>$(NoWarn);NU5104</NoWarn>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\Framework\Microsoft.Build.Framework.csproj" />
    <ProjectReference Include="..\StringTools\StringTools.csproj" />
    <PackageReference Include="Microsoft.VisualStudio.SolutionPersistence" PrivateAssets="all" />
    <PackageReference Include="System.Configuration.ConfigurationManager" />

    <PackageReference Include="System.Reflection.MetadataLoadContext" />

    <PackageReference Include="Microsoft.IO.Redist" Condition="'$(FeatureMSIORedist)' == 'true'" />

    <PackageReference Include="Microsoft.CodeAnalysis.Collections" PrivateAssets="all" />
    <PackageReference Include="Microsoft.CodeAnalysis.PooledObjects" PrivateAssets="all" />
    <PackageReference Include="Microsoft.BuildXL.Processes" Condition="'$(FeatureReportFileAccesses)' == 'true'" PrivateAssets="all" />
    <!-- Remove the direct NETStandard.Library dependency when Microsoft.BuildXL.Processes stops bringing in netstandard1.x dependencies
         or when a .NET 10 SDK is used (NuGet Package Pruning eliminates netstandard1.x dependencies). -->
    <PackageReference Include="NETStandard.Library" VersionOverride="2.0.3" PrivateAssets="all" Condition="'$(FeatureReportFileAccesses)' == 'true'" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework' and '$(DotNetBuildSourceOnly)' != 'true'">
    <PackageReference Include="Microsoft.VisualStudio.Setup.Configuration.Interop" PrivateAssets="all" />
  </ItemGroup>
  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">
    <Reference Include="System.IO.Compression" />
    <PackageReference Include="System.Memory" />
    <PackageReference Include="System.Security.Principal.Windows" />
    <PackageReference Include="System.Text.Json" />
    <PackageReference Include="System.Collections.Immutable" />
    <PackageReference Include="System.Threading.Tasks.Dataflow" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETStandard'">
    <PackageReference Include="System.Reflection.Metadata" />
    <PackageReference Include="System.Text.Encoding.CodePages" />
  </ItemGroup>

  <ItemGroup>
    <Compile Include="..\Shared\BuildEnvironmentHelper.cs">
      <Link>SharedUtilities\BuildEnvironmentHelper.cs</Link>
    </Compile>
    <Compile Include="..\Shared\EncodingStringWriter.cs">
      <Link>SharedUtilities\EncodingStringWriter.cs</Link>
    </Compile>
    <Compile Include="..\Shared\AssemblyNameComparer.cs">
      <Link>SharedUtilities\AssemblyNameComparer.cs</Link>
    </Compile>
    <Compile Include="..\Shared\AwaitExtensions.cs">
      <Link>SharedUtilities\AwaitExtensions</Link>
    </Compile>
    <Compile Include="..\Shared\AssemblyNameReverseVersionComparer.cs">
      <Link>SharedUtilities\AssemblyNameReverseVersionComparer.cs</Link>
    </Compile>
    <Compile Include="..\Shared\CanonicalError.cs">
      <Link>BackEnd\Components\RequestBuilder\IntrinsicTasks\CanonicalError.cs</Link>
    </Compile>
    <Compile Include="..\Shared\PropertyParser.cs">
      <Link>BackEnd\Components\RequestBuilder\IntrinsicTasks\PropertyParser.cs</Link>
    </Compile>
    <Compile Include="..\Shared\StringExtensions.cs">
      <Link>SharedUtilities\StringExtensions.cs</Link>
    </Compile>
    <Compile Include="..\Shared\StringUtils.cs">
      <Link>SharedUtilities\StringUtils.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ReadOnlyEmptyCollection.cs">
      <Link>Collections\ReadOnlyEmptyCollection.cs</Link>
    </Compile>
    <Compile Include="..\Shared\BufferedReadStream.cs" />
    <Compile Include="..\Shared\TaskFactoryUtilities.cs" />
    <Compile Include="..\GlobalUsings.cs" Link="GlobalUsings.cs" />
    <Compile Include="..\Shared\TaskHostConfiguration.cs" />
    <Compile Include="..\Shared\TaskHostTaskCancelled.cs" />
    <Compile Include="..\Shared\TaskHostTaskComplete.cs" />
    <Compile Include="..\Shared\OutOfProcTaskHostTaskResult.cs" />
    <Compile Include="..\Shared\TaskLoader.cs" />
    <Compile Include="..\Shared\NodeEngineShutdownReason.cs" />
    <Compile Include="..\Shared\IKeyed.cs" />
    <Compile Include="..\Shared\INodeEndpoint.cs" />
    <Compile Include="..\Shared\NodeEndpointOutOfProcBase.cs" />
    <Compile Include="..\Shared\INodePacket.cs" />
    <Compile Include="..\Shared\INodePacketFactory.cs" />
    <Compile Include="..\Shared\INodePacketHandler.cs" />
    <Compile Include="..\Shared\LogMessagePacketBase.cs" />
    <Compile Include="..\Shared\NodePacketFactory.cs" />
    <Compile Include="..\Shared\NodeBuildComplete.cs" />
    <Compile Include="..\Shared\NodeShutdown.cs" />
    <Compile Include="..\Shared\NamedPipeUtil.cs" />
    <Compile Include="..\Shared\ProcessExtensions.cs" />
    <Compile Include="..\Shared\PlatformNegotiation.cs">
      <Link>PlatformNegotiation.cs</Link>
    </Compile>
    <Compile Include="..\Shared\SolutionConfiguration.cs" />
    <Compile Include="..\Shared\TaskLoggingHelper.cs">
      <Link>BackEnd\Components\RequestBuilder\IntrinsicTasks\TaskLoggingHelper.cs</Link>
    </Compile>
    <Compile Include="..\Shared\TaskLoggingHelperExtension.cs">
      <Link>BackEnd\Components\RequestBuilder\IntrinsicTasks\TaskLoggingHelperExtension.cs</Link>
    </Compile>
    <Compile Include="..\Shared\TaskParameter.cs" />
    <Compile Include="..\Shared\TaskParameterTypeVerifier.cs" />
    <Compile Include="..\Shared\TranslatorHelpers.cs" />
    <Compile Include="..\Shared\CommunicationsUtilities.cs" />
    <Compile Include="..\Shared\InterningBinaryReader.cs" />
    <Compile Include="..\Shared\TaskEngineAssemblyResolver.cs" />
    <Compile Include="..\Shared\ThreadPoolExtensions.cs" />
    <Compile Include="AssemblyInfo.cs" />
    <Compile Include="BackEnd\BuildManager\BuildManager.cs" />
    <Compile Include="BackEnd\BuildManager\BuildParameters.cs" />
    <Compile Include="BackEnd\BuildManager\BuildRequestDataBase.cs" />
    <Compile Include="BackEnd\BuildManager\BuildSubmissionBase.cs" />
    <Compile Include="BackEnd\BuildManager\CacheSerialization.cs" />
    <Compile Include="BackEnd\BuildManager\CacheAggregator.cs" />
    <Compile Include="BackEnd\BuildManager\GlobalPropertiesLookup.cs" />
    <Compile Include="BackEnd\BuildManager\ProjectIsolationMode.cs" />
    <Compile Include="BackEnd\Client\MSBuildClientPacketPump.cs" />
    <Compile Include="BackEnd\Client\MSBuildClientExitType.cs" />
    <Compile Include="BackEnd\Client\MSBuildClientExitResult.cs" />
    <Compile Include="BackEnd\Client\MSBuildClient.cs" />
    <Compile Include="BackEnd\Components\Caching\ConfigCacheWithOverride.cs" />
    <Compile Include="BackEnd\Components\Caching\ResultsCacheWithOverride.cs" />
    <Compile Include="BackEnd\Components\ProjectCache\*.cs" />
    <Compile Include="BackEnd\Components\ProjectCache\Experimental\*.cs" />
    <Compile Include="BackEnd\Components\Communications\CurrentHost.cs" />
    <Compile Include="BackEnd\Components\Communications\DetouredNodeLauncher.cs" />
    <Compile Include="BackEnd\Components\Communications\SerializationContractInitializer.cs" />
    <Compile Include="BackEnd\Components\Communications\ServerNodeEndpointOutOfProc.cs" />
    <Compile Include="BackEnd\Components\FileAccesses\IFileAccessManager.cs" />
    <Compile Include="BackEnd\Components\FileAccesses\FileAccessManager.cs" />
    <Compile Include="BackEnd\Components\FileAccesses\FileAccessReport.cs" />
    <Compile Include="BackEnd\Components\FileAccesses\OutOfProcNodeFileAccessManager.cs" />
    <Compile Include="BackEnd\Components\FileAccesses\ProcessReport.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverServiceException.cs" />
    <Compile Include="BackEnd\Shared\EventsCreatorHelper.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\AssemblyLoadsTracker.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverException.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\TranslationHelpers.cs" />
    <Compile Include="FileSystem\*.cs" />
    <Compile Include="BackEnd\Shared\BuildResultBase.cs" />
    <Compile Include="BuildCheck\**\*.cs" />
    <Compile Include="Collections\IValueDictionaryConverter.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\IRetrievableUnescapedValuedEntryHashSet.cs" />
    <Compile Include="Evaluation\IItemTypeDefinition.cs" />
    <Compile Include="Evaluation\PropertiesUseTracker.cs" />
    <Compile Include="FileAccess\DesiredAccess.cs" />
    <Compile Include="FileAccess\FileAccessData.cs" />
    <Compile Include="FileAccess\FlagsAndAttributes.cs" />
    <Compile Include="FileAccess\ProcessData.cs" />
    <Compile Include="FileAccess\ReportedFileOperation.cs" />
    <Compile Include="FileAccess\RequestedAccess.cs" />
    <Compile Include="Instance\IPropertyElementWithLocation.cs" />
    <Compile Include="Logging\BuildEventArgsExtensions.cs" />
    <Compile Include="Logging\TerminalLogger\**\*.cs" />
    <Compile Include="Logging\ReusableLogger.cs" />
    <Compile Include="TelemetryInfra\InternalTelemetryConsumingLogger.cs" />
    <Compile Include="TelemetryInfra\ITelemetryForwarder.cs" />
    <Compile Include="TelemetryInfra\TelemetryForwarderProvider.cs" />
    <Compile Include="Utilities\ReaderWriterLockSlimExtensions.cs" />
    <Compile Include="BackEnd\Node\ConsoleOutput.cs" />
    <Compile Include="BackEnd\Node\PartialBuildTelemetry.cs" />
    <Compile Include="BackEnd\Node\ServerNamedMutex.cs" />
    <Compile Include="BackEnd\Node\ServerNodeBuildCancel.cs" />
    <Compile Include="BackEnd\Node\ServerNodeBuildCommand.cs" />
    <Compile Include="BackEnd\Node\ServerNodeConsoleWrite.cs" />
    <Compile Include="BackEnd\Node\ServerNodeBuildResult.cs" />
    <Compile Include="BackEnd\Node\OutOfProcServerNode.cs" />
    <Compile Include="Logging\ConsoleConfiguration.cs" />
    <Compile Include="Logging\IConsoleConfiguration.cs" />
    <Compile Include="Logging\InProcessConsoleConfiguration.cs" />
    <Compile Include="Logging\TargetConsoleConfiguration.cs" />
    <Compile Include="Utilities\ImmutableCollectionsExtensions.cs" />
    <Compile Include="Utilities\NuGetFrameworkWrapper.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectUsingTaskParameterElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ExternalProjectsProvider.cs" />
    <Compile Include="ObjectModelRemoting\LinkedObjectFactory.cs" />
    <Compile Include="ObjectModelRemoting\DefinitionObjectsLinks\ProjectItemDefinitionLink.cs" />
    <Compile Include="ObjectModelRemoting\DefinitionObjectsLinks\ProjectItemLink.cs" />
    <Compile Include="ObjectModelRemoting\DefinitionObjectsLinks\ProjectLink.cs" />
    <Compile Include="Evaluation\PropertyTrackingEvaluatorDataWrapper.cs" />
    <Compile Include="Graph\GraphBuilder.cs" />
    <Compile Include="Graph\ParallelWorkSet.cs" />
    <Compile Include="Graph\ProjectInterpretation.cs" />
    <Compile Include="Graph\GraphBuildResult.cs" />
    <Compile Include="Graph\GraphBuildSubmission.cs" />
    <Compile Include="Graph\GraphBuildRequestData.cs" />
    <Compile Include="BackEnd\BuildManager\BuildSubmission.cs" />
    <Compile Include="BackEnd\BuildManager\LegacyThreadingData.cs" />
    <Compile Include="BackEnd\BuildManager\RequestedProjectState.cs" />
    <Compile Include="BackEnd\Components\BuildComponentFactoryCollection.cs" />
    <Compile Include="BackEnd\Components\Caching\IRegisteredTaskObjectCache.cs" />
    <Compile Include="..\Shared\RegisteredTaskObjectCacheBase.cs" />
    <Compile Include="BackEnd\Components\Caching\RegisteredTaskObjectCache.cs" />
    <Compile Include="BackEnd\Components\Logging\EvaluationLoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\BuildLoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\LoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\BuildEventArgTransportSink.cs" />
    <Compile Include="BackEnd\Components\Logging\CentralForwardingLogger.cs" />
    <Compile Include="BackEnd\Components\Logging\EventRedirectorToSink.cs" />
    <Compile Include="BackEnd\Components\Logging\EventSourceSink.cs" />
    <Compile Include="BackEnd\Components\Logging\ForwardingLoggerRecord.cs" />
    <Compile Include="BackEnd\Components\Logging\ILoggingService.cs" />
    <Compile Include="BackEnd\Components\Logging\LoggingService.cs" />
    <Compile Include="BackEnd\Components\Logging\LoggingServiceFactory.cs" />
    <Compile Include="BackEnd\Components\Logging\LoggingServiceLogMethods.cs" />
    <Compile Include="BackEnd\Components\Logging\NodeLoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\ProjectLoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\ProjectTelemetry.cs" />
    <Compile Include="BackEnd\Components\Logging\TargetLoggingContext.cs" />
    <Compile Include="BackEnd\Components\Logging\TaskLoggingContext.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\CallTarget.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\IntrinsicTaskFactory.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\ItemGroupLoggingHelper.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\MSBuild.cs" />
    <Compile Include="BackEnd\Components\Scheduler\SchedulableRequest.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\FullTracking.cs" />
    <Compile Include="BackEnd\Components\Scheduler\SchedulingData.cs" />
    <Compile Include="BackEnd\Components\Scheduler\Scheduler.cs" />
    <Compile Include="BackEnd\Components\Scheduler\SchedulerCircularDependencyException.cs" />
    <Compile Include="BackEnd\Components\Scheduler\ScheduleTimeRecord.cs" />
    <Compile Include="BackEnd\Components\Scheduler\SchedulingPlan.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\CachingSdkResolverLoader.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\DefaultSdkResolver.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\ISdkResolverService.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\OutOfProcNodeSdkResolverService.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\OutOfProcNodeSdkResolverServiceFactory.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkLogger.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\CachingSdkResolverService.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverContext.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverLoader.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverManifest.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverRequest.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\MainNodeSdkResolverService.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResolverService.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\HostedSdkResolverServiceBase.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResult.cs" />
    <Compile Include="BackEnd\Components\SdkResolution\SdkResultFactory.cs" />
    <Compile Include="BackEnd\Node\LoggingNodeConfiguration.cs" />
    <Compile Include="BackEnd\Shared\ConfigurationMetadata.cs" />
    <Compile Include="Construction\ImplicitImportLocation.cs" />
    <Compile Include="Construction\ProjectSdkElement.cs" />
    <Compile Include="Definition\ProjectOptions.cs" />
    <Compile Include="Definition\NewProjectFileOptions.cs" />
    <Compile Include="Definition\ProjectCollectionChangedEventArgs.cs" />
    <Compile Include="Definition\ProjectImportPathMatch.cs" />
    <Compile Include="Definition\ProjectLoadSettings.cs" />
    <Compile Include="Definition\ToolsetLocalReader.cs" />
    <Compile Include="Evaluation\Context\EvaluationContext.cs" />
    <Compile Include="Evaluation\Profiler\EvaluationLocationMarkdownPrettyPrinter.cs" />
    <Compile Include="Evaluation\Profiler\EvaluationLocationPrettyPrinterBase.cs" />
    <Compile Include="Evaluation\Profiler\EvaluationLocationTabSeparatedPrettyPrinter.cs" />
    <Compile Include="Evaluation\Profiler\EvaluationProfiler.cs" />
    <Compile Include="Evaluation\ItemSpec.cs" />
    <Compile Include="Evaluation\ItemsAndMetadataPair.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.IItemOperation.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.UpdateOperation.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.IncludeOperation.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.ItemFactoryWrapper.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.RemoveOperation.cs" />
    <Compile Include="Evaluation\LazyItemEvaluator.OrderedItemDataCollection.cs" />
    <Compile Include="Evaluation\ItemDataCollectionValue.cs" />
    <Compile Include="Evaluation\MetadataReference.cs" />
    <Compile Include="Graph\ProjectGraphEntryPoint.cs" />
    <Compile Include="Graph\ProjectGraph.cs" />
    <Compile Include="Graph\ProjectGraphNode.cs" />
    <Compile Include="Instance\HostObjectException.cs" />
    <Compile Include="Instance\IRunningObjectTableWrapper.cs" />
    <Compile Include="Instance\RunningObjectTable.cs" />
    <Compile Include="Logging\EvaluationLocationIdAgnosticComparer.cs" />
    <Compile Include="Logging\ProfilerLogger.cs" />
    <Compile Include="Evaluation\Profiler\ProfilerResultPrettyPrinter.cs" />
    <Compile Include="Evaluation\ProjectChangedEventArgs.cs" />
    <Compile Include="Evaluation\ProjectXmlChangedEventArgs.cs" />
    <Compile Include="Construction\Solution\SolutionProjectGenerator.cs" />
    <Compile Include="Evaluation\IToolsetProvider.cs" />
    <Compile Include="BackEnd\Components\Caching\ResultsCacheResponse.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeEndpointOutOfProc.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeManager.cs" />
    <Compile Include="BackEnd\Components\Communications\TaskHostNodeManager.cs" />
    <Compile Include="BackEnd\Components\Communications\LogMessagePacket.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeFailedToLaunchException.cs" />
    <Compile Include="BackEnd\Components\BuildRequestEngine\BuildRequestConfigurationResponse.cs" />
    <Compile Include="BackEnd\Components\BuildRequestEngine\BuildRequestEngine.cs" />
    <Compile Include="BackEnd\Components\BuildRequestEngine\BuildRequestEntry.cs" />
    <Compile Include="BackEnd\Components\BuildRequestEngine\FullyQualifiedBuildRequest.cs" />
    <Compile Include="BackEnd\Components\Caching\IConfigCache.cs" />
    <Compile Include="BackEnd\Components\Caching\ResultsCache.cs" />
    <Compile Include="BackEnd\Components\Caching\ConfigCache.cs" />
    <Compile Include="BackEnd\Components\Caching\IPropertyCache.cs" />
    <Compile Include="BackEnd\Components\Caching\IResultsCache.cs" />
    <Compile Include="BackEnd\Components\Communications\TranslatorExtensions.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeProviderOutOfProc.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeProviderOutOfProcBase.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeProviderOutOfProcTaskHost.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\BatchingEngine.cs" />
    <Compile Include="BackEnd\BuildManager\BuildRequestData.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTask.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\ItemGroupIntrinsicTask.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IntrinsicTasks\PropertyGroupIntrinsicTask.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\ITargetBuilderCallback.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TargetSpecification.cs" />
    <Compile Include="BackEnd\Node\InProcNode.cs" />
    <Compile Include="BackEnd\Node\NodeConfiguration.cs" />
    <Compile Include="BackEnd\Node\OutOfProcNode.cs" />
    <Compile Include="BackEnd\Node\NativeMethods.cs" />
    <Compile Include="BackEnd\Shared\BuildAbortedException.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IRequestBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\IRequestBuilderCallback.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\ITargetBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\ITaskBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\ItemBucket.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\Lookup.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\RequestBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TargetBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TargetEntry.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TargetUpToDateChecker.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TaskBuilder.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TaskHost.cs" />
    <Compile Include="BackEnd\Components\RequestBuilder\TaskRouter.cs" />
    <Compile Include="BackEnd\Shared\BuildRequest.cs" />
    <Compile Include="BackEnd\Shared\BuildRequestBlocker.cs" />
    <Compile Include="BackEnd\Shared\BuildRequestConfiguration.cs" />
    <Compile Include="BackEnd\Shared\BuildResult.cs" />
    <Compile Include="BackEnd\Shared\ResourceRequest.cs" />
    <Compile Include="BackEnd\Shared\ResourceResponse.cs" />
    <Compile Include="BackEnd\Shared\CircularDependencyException.cs" />
    <Compile Include="BackEnd\Shared\BuildRequestUnblocker.cs" />
    <Compile Include="BackEnd\Shared\IBuildResults.cs" />
    <Compile Include="BackEnd\Shared\ITargetResult.cs" />
    <Compile Include="BackEnd\Shared\TargetResult.cs" />
    <Compile Include="BackEnd\Shared\WorkUnitResult.cs" />
    <Compile Include="BackEnd\Components\BuildRequestEngine\IBuildRequestEngine.cs" />
    <Compile Include="BackEnd\Components\Communications\INodeLauncher.cs" />
    <Compile Include="BackEnd\Components\Communications\INodeManager.cs" />
    <Compile Include="BackEnd\Components\Communications\INodeProvider.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeEndpointInProc.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeInfo.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeLauncher.cs" />
    <Compile Include="BackEnd\Components\Communications\NodeProviderInProc.cs" />
    <Compile Include="BackEnd\Components\Communications\RarNodeLauncher.cs" />
    <Compile Include="BackEnd\Components\IBuildComponent.cs" />
    <Compile Include="BackEnd\Components\IBuildComponentHost.cs" />
    <Compile Include="BackEnd\Components\Scheduler\IScheduler.cs" />
    <Compile Include="BackEnd\Components\Scheduler\ScheduleResponse.cs" />
    <Compile Include="BackEnd\Node\INode.cs" />
    <!-- ########################## -->
    <Compile Include="BackEnd\TaskExecutionHost\TaskExecutionHost.cs" />
    <Compile Include="BackEnd\TaskExecutionHost\MultiProcessTaskEnvironmentDriver.cs" />
    <Compile Include="BackEnd\TaskExecutionHost\MultiThreadedTaskEnvironmentDriver.cs" />
    <!-- #### COLLECTIONS ### -->
    <Compile Include="..\Shared\CollectionHelpers.cs" />
    <Compile Include="Collections\ArrayDictionary.cs" />
    <Compile Include="Collections\ConcurrentQueueExtensions.cs" />
    <Compile Include="Collections\ConcurrentStackExtensions.cs" />
    <Compile Include="Collections\ConvertingEnumerable.cs" />
    <Compile Include="Collections\CopyOnReadEnumerable.cs" />
    <Compile Include="..\Shared\CopyOnWriteDictionary.cs">
      <Link>Collections\CopyOnWriteDictionary.cs</Link>
    </Compile>
    <Compile Include="Collections\CopyOnWritePropertyDictionary.cs" />
    <Compile Include="Collections\HashTableUtility.cs" />
    <Compile Include="Collections\IConstrainableDictionary.cs" />
    <Compile Include="Collections\ICopyOnWritePropertyDictionary.cs" />
    <Compile Include="Collections\IItemDictionary.cs" />
    <Compile Include="Collections\IMultiDictionary.cs" />
    <Compile Include="Collections\ItemDictionary.cs" />
    <Compile Include="Collections\ItemDictionarySlim.cs" />
    <Compile Include="Collections\IImmutable.cs" />
    <Compile Include="Collections\MultiDictionary.cs" />
    <Compile Include="Collections\IValued.cs" />
    <Compile Include="Collections\LookasideStringInterner.cs" />
    <Compile Include="Collections\PropertyDictionary.cs" />
    <Compile Include="..\Shared\ReadOnlyCollection.cs" />
    <Compile Include="Collections\ReadOnlyConvertingDictionary.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\BitHelper.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\HashSetDebugView.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\HashHelpers.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\IRetrievableEntryHashSet.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\IRetrievableValuedEntryHashSet.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\RetrievableEntryHashSet.cs" />
    <Compile Include="Collections\RetrievableEntryHashSet\RetrievableValuedEntryHashSet.cs" />
    <Compile Include="Collections\WeakValueDictionary.cs" />
    <!-- #### CONSTRUCTION MODEL ### -->
    <Compile Include="Construction\ProjectElement.cs" />
    <Compile Include="Construction\ProjectElementContainer.cs" />
    <Compile Include="Construction\ProjectImportElement.cs" />
    <Compile Include="Construction\ProjectImportGroupElement.cs" />
    <Compile Include="Construction\ProjectItemDefinitionGroupElement.cs" />
    <Compile Include="Construction\ProjectItemDefinitionElement.cs" />
    <Compile Include="Construction\ProjectItemGroupElement.cs" />
    <Compile Include="Construction\ProjectItemElement.cs" />
    <Compile Include="Construction\ProjectMetadataElement.cs" />
    <Compile Include="Construction\ProjectOnErrorElement.cs" />
    <Compile Include="Construction\ProjectOtherwiseElement.cs" />
    <Compile Include="Construction\ProjectOutputElement.cs" />
    <Compile Include="Construction\ProjectExtensionsElement.cs" />
    <Compile Include="Construction\ProjectPropertyGroupElement.cs" />
    <Compile Include="Construction\ProjectPropertyElement.cs" />
    <Compile Include="Construction\ProjectTargetElement.cs" />
    <Compile Include="Construction\ProjectTaskElement.cs" />
    <Compile Include="Construction\ProjectUsingTaskElement.cs" />
    <Compile Include="Construction\ProjectRootElement.cs" />
    <Compile Include="Construction\ProjectChooseElement.cs" />
    <Compile Include="Construction\ProjectWhenElement.cs" />
    <Compile Include="Construction\UsingTaskParameterGroupElement.cs" />
    <Compile Include="Construction\ProjectUsingTaskParameterElement.cs" />
    <Compile Include="Construction\ProjectUsingTaskBodyElement.cs" />
    <Compile Include="Construction\Solution\SolutionConfigurationInSolution.cs" />
    <Compile Include="Construction\Solution\ProjectConfigurationInSolution.cs" />
    <Compile Include="Construction\Solution\ProjectInSolution.cs" />
    <Compile Include="Construction\Solution\SolutionFile.cs" />
    <!-- #### DEFINITION MODEL ### -->
    <Compile Include="Definition\BuiltInMetadata.cs" />
    <Compile Include="Definition\ProjectCollection.cs" />
    <Compile Include="Definition\Project.cs" />
    <Compile Include="Definition\ProjectItem.cs" />
    <Compile Include="Definition\ProjectItemDefinition.cs" />
    <Compile Include="Definition\ProjectMetadata.cs" />
    <Compile Include="Definition\ProjectProperty.cs" />
    <Compile Include="Definition\ResolvedImport.cs" />
    <Compile Include="Definition\SubToolset.cs" />
    <Compile Include="Definition\Toolset.cs" />
    <Compile Include="Definition\ToolsetConfigurationReader.cs" />
    <Compile Include="..\Shared\ToolsetElement.cs" />
    <Compile Include="Definition\ToolsetPropertyDefinition.cs" />
    <Compile Include="Definition\ToolsetReader.cs" />
    <Compile Include="Definition\ToolsetRegistryReader.cs" />
    <!-- ######################## -->
    <Compile Include="ElementLocation\ElementLocation.cs" />
    <Compile Include="ElementLocation\RegistryLocation.cs" />
    <Compile Include="ElementLocation\XmlAttributeWithLocation.cs" />
    <Compile Include="ElementLocation\XmlDocumentWithLocation.cs" />
    <Compile Include="ElementLocation\XmlElementWithLocation.cs" />
    <Compile Include="ElementLocation\XmlNameTableThreadSafe.cs" />
    <Compile Include="Errors\InternalLoggerException.cs" />
    <Compile Include="Errors\InvalidProjectFileException.cs" />
    <Compile Include="Errors\InvalidToolsetDefinitionException.cs" />
    <Compile Include="Errors\RegistryException.cs" />
    <!-- #### EVALUATION ### -->
    <Compile Include="Evaluation\ConditionEvaluator.cs" />
    <Compile Include="Evaluation\Conditionals\AndExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\CharacterUtilities.cs" />
    <Compile Include="Evaluation\Conditionals\EqualExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\FunctionCallExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\GenericExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\GreaterThanExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\GreaterThanOrEqualExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\LessThanExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\LessThanOrEqualExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\MultipleComparisonExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\NotEqualExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\NotExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\NumericComparisonExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\NumericExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\OperandExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\OperatorExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\OrExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\Parser.cs" />
    <Compile Include="Evaluation\Conditionals\Scanner.cs" />
    <Compile Include="Evaluation\Conditionals\StringExpressionNode.cs" />
    <Compile Include="Evaluation\Conditionals\Token.cs" />
    <Compile Include="Evaluation\EvaluatorMetadataTable.cs" />
    <Compile Include="Evaluation\IEvaluatorData.cs" />
    <Compile Include="Evaluation\IItem.cs" />
    <Compile Include="Evaluation\IItemDefinition.cs" />
    <Compile Include="Evaluation\IItemFactory.cs" />
    <Compile Include="Evaluation\Conditionals\IItem.cs" />
    <Compile Include="Evaluation\IItemProvider.cs" />
    <Compile Include="Evaluation\IMetadataTable.cs" />
    <Compile Include="Evaluation\IntrinsicFunctions.cs" />
    <Compile Include="Evaluation\IMetadatum.cs" />
    <Compile Include="Evaluation\IProjectMetadataParent.cs" />
    <Compile Include="Evaluation\IProperty.cs" />
    <Compile Include="Evaluation\IPropertyProvider.cs" />
    <Compile Include="Evaluation\Preprocessor.cs" />
    <Compile Include="Evaluation\ProjectParser.cs" />
    <Compile Include="Evaluation\ProjectRootElementCacheBase.cs" />
    <Compile Include="Evaluation\ProjectRootElementCache.cs" />
    <Compile Include="Evaluation\SimpleProjectRootElementCache.cs" />
    <Compile Include="Evaluation\SemiColonTokenizer.cs" />
    <Compile Include="Evaluation\StringMetadataTable.cs" />
    <Compile Include="Evaluation\ExpressionShredder.cs" />
    <Compile Include="Evaluation\Evaluator.cs" />
    <Compile Include="Evaluation\Expander.cs" />
    <Compile Include="Evaluation\ToolsetProvider.cs" />
    <Compile Include="Evaluation\Expander\ArgumentParser.cs" />
    <Compile Include="Evaluation\Expander\WellKnownFunctions.cs" />
    <Compile Include="Globbing\CompositeGlob.cs" />
    <Compile Include="Globbing\Extensions\MSBuildGlobExtensions.cs" />
    <Compile Include="Globbing\Visitor\GlobVisitor.cs" />
    <Compile Include="Globbing\MSBuildGlobWithGaps.cs" />
    <Compile Include="Globbing\MSBuildGlob.cs" />
    <Compile Include="Globbing\IMSBuildGlob.cs" />
    <Compile Include="Globbing\Visitor\ParsedGlobCollector.cs" />
    <!-- #### INSTANCE MODEL ### -->
    <Compile Include="Instance\IImmutableInstanceProvider.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableElementCollectionConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableGlobalPropertiesCollectionConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableItemDefinitionsListConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableItemDictionary.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableLinkedMultiDictionaryConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableProjectMetadataCollectionConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\ImmutableProjectPropertyCollectionConverter.cs" />
    <Compile Include="Instance\ImmutableProjectCollections\LazyStringValuedList.cs" />
    <Compile Include="Instance\ReflectableTaskPropertyInfo.cs" />
    <Compile Include="Instance\HostServices.cs" />
    <Compile Include="Instance\ProjectTargetInstanceChild.cs" />
    <Compile Include="Instance\ProjectTaskInstanceChild.cs" />
    <Compile Include="Instance\ProjectInstance.cs" />
    <Compile Include="Instance\ProjectItemDefinitionInstance.cs" />
    <Compile Include="Instance\ProjectItemGroupTaskInstance.cs" />
    <Compile Include="Instance\ProjectItemGroupTaskItemInstance.cs" />
    <Compile Include="Instance\ProjectItemGroupTaskMetadataInstance.cs" />
    <Compile Include="Instance\ProjectItemInstance.cs" />
    <Compile Include="Instance\ProjectMetadataInstance.cs" />
    <Compile Include="Instance\ProjectOnErrorInstance.cs" />
    <Compile Include="Instance\ProjectPropertyGroupTaskInstance.cs" />
    <Compile Include="Instance\ProjectPropertyGroupTaskPropertyInstance.cs" />
    <Compile Include="Instance\ProjectPropertyInstance.cs" />
    <Compile Include="Instance\ProjectTargetInstance.cs" />
    <Compile Include="Instance\ProjectTaskInstance.cs" />
    <Compile Include="Instance\ProjectTaskOutputItemInstance.cs" />
    <Compile Include="Instance\ProjectTaskOutputPropertyInstance.cs" />
    <Compile Include="Instance\TaskFactories\AssemblyTaskFactory.cs" />
    <Compile Include="Instance\TaskFactories\TaskHostTask.cs" />
    <Compile Include="Instance\TaskFactoryEngineContext.cs" />
    <Compile Include="Instance\TaskFactoryWrapper.cs" />
    <Compile Include="Instance\TaskRegistry.cs" />
    <!-- ######################## -->
    <Compile Include="Evaluation\LazyItemEvaluator.LazyItemOperation.cs" />
    <Compile Include="Logging\BaseConsoleLogger.cs" />
    <Compile Include="Logging\BinaryLogger\BinaryLogger.cs" />
    <Compile Include="Logging\BinaryLogger\BinaryLogRecordKind.cs" />
    <Compile Include="Logging\BinaryLogger\BinaryLogReplayEventSource.cs" />
    <Compile Include="Logging\BinaryLogger\EventArgsDispatcher.cs" />
    <Compile Include="Logging\BinaryLogger\BuildEventArgsFieldFlags.cs" />
    <Compile Include="Logging\BinaryLogger\BuildEventArgsFields.cs" />
    <Compile Include="Logging\BinaryLogger\BuildEventArgsReader.cs" />
    <Compile Include="Logging\BinaryLogger\BuildEventArgsWriter.cs" />
    <Compile Include="Logging\BinaryLogger\ProjectImportsCollector.cs" />
    <Compile Include="Logging\BinaryLogger\ExtendedDataFields.cs" />
    <Compile Include="Logging\BinaryLogger\Postprocessing\*.cs" />
    <Compile Include="Logging\ConsoleLogger.cs" />
    <Compile Include="Logging\DistributedLoggers\DistributedFileLogger.cs" />
    <Compile Include="Logging\DistributedLoggers\ConfigurableForwardingLogger.cs" />
    <Compile Include="Logging\NullCentralLogger.cs" />
    <Compile Include="Logging\LoggerDescription.cs" />
    <Compile Include="Logging\OptimizedStringIndenter.cs" />
    <Compile Include="Logging\ParallelLogger\ParallelLoggerHelpers.cs" />
    <Compile Include="Logging\ParallelLogger\ParallelConsoleLogger.cs" />
    <Compile Include="Logging\SimpleErrorLogger.cs" />
    <Compile Include="Logging\ParallelLogger\ConsoleOutputAligner.cs" />
    <Compile Include="Logging\FileLogger.cs" />
    <Compile Include="Logging\LogFormatter.cs" />
    <Compile Include="ObjectModelRemoting\DefinitionObjectsLinks\ProjectMetadataLink.cs" />
    <Compile Include="ObjectModelRemoting\DefinitionObjectsLinks\ProjectPropertyLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectElementContainerLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectExtensionsElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectImportElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectItemElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectMetadataElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectPropertyElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectRootElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectTargetElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectTaskElementLink.cs" />
    <Compile Include="ObjectModelRemoting\ConstructionObjectLinks\ProjectUsingTaskBodyElementLink.cs" />
    <Compile Include="Resources\AssemblyResources.cs" />
    <Compile Include="Resources\Constants.cs" />
    <Compile Include="Resources\MSBuildAssemblyFileVersion.cs" />
    <!-- ######################## -->
    <!-- ######################## -->
    <!-- ######################## -->
    <Compile Include="Utilities\EngineFileUtilities.cs" />
    <Compile Include="Utilities\FileSpecMatchTester.cs" />
    <Compile Include="Utilities\RegistryKeyWrapper.cs" />
    <Compile Include="Utilities\Utilities.cs" />
    <Compile Include="Utilities\SimpleVersion.cs" />
    <Compile Include="Xml\ProjectXmlUtilities.XmlElementChildIterator.cs" />
    <Compile Include="Xml\ProjectXmlUtilities.cs" />
    <Compile Include="Xml\XmlReaderExtension.cs" />
    <Compile Include="..\Shared\AssemblyLoadInfo.cs">
      <Link>SharedUtilities\AssemblyLoadInfo.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ReadOnlyEmptyDictionary.cs">
      <Link>SharedUtilities\ReadOnlyEmptyDictionary.cs</Link>
    </Compile>
    <Compile Include="..\Shared\AssemblyNameExtension.cs">
      <Link>SharedUtilities\AssemblyNameExtension.cs</Link>
    </Compile>
    <Compile Include="..\Shared\BuildEventFileInfo.cs">
      <Link>SharedUtilities\BuildEventFileInfo.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ConversionUtilities.cs">
      <Link>SharedUtilities\ConversionUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\FileDelegates.cs">
      <Link>SharedUtilities\FileDelegates.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ErrorUtilities.cs">
      <Link>Errors\ErrorUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\EscapingUtilities.cs">
      <Link>SharedUtilities\EscapingUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\VersionUtilities.cs">
      <Link>SharedUtilities\VersionUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\EventArgsFormatting.cs">
      <Link>SharedUtilities\EventArgsFormatting.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ExceptionHandling.cs">
      <Link>SharedUtilities\ExceptionHandling.cs</Link>
    </Compile>
    <Compile Include="..\Shared\FileMatcher.cs">
      <Link>SharedUtilities\FileMatcher.cs</Link>
    </Compile>
    <Compile Include="..\Shared\FileUtilities.cs">
      <Link>SharedUtilities\FileUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\TempFileUtilities.cs" />
    <Compile Include="..\Shared\Modifiers.cs" />
    <Compile Include="..\Shared\FileUtilitiesRegex.cs">
      <Link>SharedUtilities\FileUtilitiesRegex.cs</Link>
    </Compile>
    <Compile Include="..\Shared\FrameworkLocationHelper.cs">
      <Link>SharedUtilities\FrameworkLocationHelper.cs</Link>
    </Compile>
    <Compile Include="..\Shared\IElementLocation.cs">
      <Link>SharedUtilities\IElementLocation.cs</Link>
    </Compile>
    <Compile Include="..\Shared\LoadedType.cs">
      <Link>SharedUtilities\LoadedType.cs</Link>
    </Compile>
    <Compile Include="..\Shared\TypeUtilities.cs">
      <Link>SharedUtilities\TypeUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\InprocTrackingNativeMethods.cs">
      <Link>InprocTrackingNativeMethods.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ProjectErrorUtilities.cs">
      <Link>Errors\ProjectErrorUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ProjectFileErrorUtilities.cs">
      <Link>Errors\ProjectFileErrorUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ProjectWriter.cs">
      <Link>SharedUtilities\ProjectWriter.cs</Link>
    </Compile>
    <Compile Include="..\Shared\ResourceUtilities.cs">
      <Link>SharedUtilities\ResourceUtilities.cs</Link>
    </Compile>
    <Compile Include="..\Shared\Tracing.cs" />
    <Compile Include="..\Shared\CoreCLRAssemblyLoader.cs" Condition="'$(TargetFrameworkIdentifier)'!='.NETFramework'" />
    <Compile Include="..\Shared\TypeLoader.cs">
      <Link>SharedUtilities\TypeLoader.cs</Link>
    </Compile>
    <Compile Include="..\Shared\MSBuildLoadContext.cs" Condition="'$(TargetFrameworkIdentifier)'!='.NETFramework'">
      <Link>SharedUtilities\MSBuildLoadContext.cs</Link>
    </Compile>
    <Compile Include="..\Shared\VisualStudioConstants.cs">
      <Link>VisualStudioConstants.cs</Link>
    </Compile>
    <Compile Include="..\Shared\XMakeAttributes.cs">
      <Link>Resources\XMakeAttributes.cs</Link>
    </Compile>
    <Compile Include="..\Shared\XMakeElements.cs">
      <Link>Resources\XMakeElements.cs</Link>
    </Compile>
    <Compile Include="..\Shared\XmlUtilities.cs">
      <Link>SharedUtilities\XmlUtilities.cs</Link>
    </Compile>
    <Compile Include="Evaluation\LazyItemEvaluator.EvaluatorData.cs" />

    <!-- Win32 RC Files -->
    <RCResourceFile Include="native.rc" />
    <!-- Resource Files -->
    <EmbeddedResource Include="Resources\Strings.resx">
      <LogicalName>$(AssemblyName).Strings.resources</LogicalName>
      <SubType>Designer</SubType>
    </EmbeddedResource>
    <EmbeddedResource Include="..\Shared\Resources\Strings.shared.resx">
      <Link>Resources\Strings.shared.resx</Link>
      <SubType>Designer</SubType>
      <LogicalName>$(AssemblyName).Strings.shared.resources</LogicalName>
    </EmbeddedResource>
  </ItemGroup>

  <PropertyGroup>
    <NuGetFrameworkWrapperRedirects_FilePath>$(IntermediateOutputPath)NuGetFrameworkWrapper.redirects.cs</NuGetFrameworkWrapperRedirects_FilePath>
  </PropertyGroup>

  <!-- Extract binding redirects for MSBuild and dependencies from MSBuild.exe.config into a source file.
       This allows us to create secondary AppDomains with the same redirects at run-time, see
       https://github.com/dotnet/msbuild/blob/main/documentation/NETFramework-NGEN.md#nugetframeworks -->
  <Target Name="GenerateAppDomainConfig" Inputs="..\MSBuild\app.config;..\MSBuild\app.amd64.config;$(MSBuildThisFileFullPath)" Outputs="$(NuGetFrameworkWrapperRedirects_FilePath)" BeforeTargets="CoreCompile" Condition="'$(FeatureAppDomain)' == 'true'">
    <PropertyGroup>
      <BindingRedirectNamespace>&lt;Namespace Prefix='ns' Uri='urn:schemas-microsoft-com:asm.v1' /&gt;</BindingRedirectNamespace>
      <BindingRedirectXPath>/configuration/runtime/ns:assemblyBinding/*</BindingRedirectXPath>
    </PropertyGroup>

    <XmlPeek XmlInputPath="..\MSBuild\app.config" Query="$(BindingRedirectXPath)" Namespaces="$(BindingRedirectNamespace)">
      <Output TaskParameter="Result" ItemName="BindingRedirects32" />
    </XmlPeek>
    <XmlPeek XmlInputPath="..\MSBuild\app.amd64.config" Query="$(BindingRedirectXPath)" Namespaces="$(BindingRedirectNamespace)">
      <Output TaskParameter="Result" ItemName="BindingRedirects64" />
    </XmlPeek>

    <PropertyGroup>
      <NuGetFrameworkWrapperRedirects_Content><![CDATA[
// Licensed to the .NET Foundation under one or more agreements.
// The .NET Foundation licenses this file to you under the MIT license.

namespace Microsoft.Build.Evaluation%3B;

[System.CodeDom.Compiler.GeneratedCode("GenerateAppDomainConfig", "1.0")]
internal sealed partial class NuGetFrameworkWrapper
{
    private const string _bindingRedirects32 = """;@(BindingRedirects32);"""%3B;
    private const string _bindingRedirects64 = """;@(BindingRedirects64);"""%3B;
}
]]>
      </NuGetFrameworkWrapperRedirects_Content>
    </PropertyGroup>

    <WriteLinesToFile File="$(NuGetFrameworkWrapperRedirects_FilePath)" Overwrite="true" WriteOnlyWhenDifferent="true" Lines="$(NuGetFrameworkWrapperRedirects_Content)" />

    <ItemGroup>
      <Compile Remove="$(NuGetFrameworkWrapperRedirects_FilePath)" />
      <Compile Include="$(NuGetFrameworkWrapperRedirects_FilePath)">
        <Link>Utilities\NuGetFrameworkWrapper.redirects.cs</Link>
      </Compile>
      <FileWrites Include="$(NuGetFrameworkWrapperRedirects_FilePath)" />
    </ItemGroup>
  </Target>
</Project>
